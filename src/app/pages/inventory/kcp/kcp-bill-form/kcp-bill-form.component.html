
<p-toast></p-toast>
<div *ngIf="!base64">
  <app-card>
    <div class="form-group row">
      <div class="col-md-3">
        <div class="field">
          <label class="p-float-label" for="billNo">Bill No</label>
          <input type="text" class="p-inputtext large-input" id="billNo" [(ngModel)]="kcpBill.billNo" required autofocus />
          <!-- <small class="p-error" *ngIf="submitted && !message.question">Bill No is required.</small> -->
        </div>
      </div>

      <div class="col-md-3">
        <div class="field">
          <label class="p-float-label" for="workOrderNo">Work Order No</label>
          <input type="text" class="p-inputtext large-input" id="workOrderNo" [(ngModel)]="kcpBill.workOrderNo" required autofocus />
          <!-- <small class="p-error" *ngIf="submitted && !message.question">Work Order No is required.</small> -->
        </div>
      </div>
      <div class="col-md-3">
        <div class="field">
          <label class="p-float-label" for="vehicleNo">Vehicle No</label>
          <input type="text" class="p-inputtext large-input" id="vehicleNo" [(ngModel)]="kcpBill.vehicleNo" required autofocus />
          <!-- <small class="p-error" *ngIf="submitted && !message.question">Work Order No is required.</small> -->
        </div>
      </div>
      <div class="col-md-3">
        <div class="field">
          <label class="p-float-label" for="date">Date</label>
          <input type="date" class="p-inputtext large-input" id="date" [(ngModel)]="kcpBill.date" required autofocus />

          <!-- <small class="p-error" *ngIf="submitted && !message.question">Date is required.</small> -->
        </div>
      </div>
    </div>
  </app-card>
  <app-card>
    <p-button type="button" icon="pi pi-plus" (onClick)="addRowPartLine()" styleClass="p-button-text"></p-button>
    <p-button type="button" icon="pi pi-minus" (onClick)="deleteRow('part')" styleClass="p-button-text"></p-button>
    <jqxGrid #dataTable        [width]="'100%'"
             [source]="dataAdapter" [columns]="columns"
             (onCellendedit)="calculatePartsBill()" [autoheight]='true'
             [theme]="'office'" [sortable]="true"  [filterable]="true" [editable]="true" [selectionmode]='"multiplerows"' >
    </jqxGrid>
    <div class="form-group row" style="padding-top: 2rem;">
      <div class="col-md-12 d-flex justify-content-end">
        <div class="field">
          <label class="p-float-label" for="totalPartsBill">Parts Total Bill</label>
        </div>
        <div class="field" style="padding-left: 2rem">
          <input type="text" disabled class="p-inputtext" id="totalPartsBill" [(ngModel)]="kcpBill.totalPartsBill"  required autofocus />
          <!-- <small class="p-error" *ngIf="submitted && !message.question">Bill No is required.</small> -->
        </div>
      </div>
    </div>
  </app-card>
  <app-card>
    <p-button type="button" icon="pi pi-plus" (onClick)="addRowLabourRateLine()" styleClass="p-button-text"></p-button>
    <p-button type="button" icon="pi pi-minus" (onClick)="deleteRow('Labour')" styleClass="p-button-text"></p-button>
    <jqxGrid #labourRateDataTable   (onCellvaluechanged)="OnRowSelect($event)" [autoheight]='true'  [width]="'100%'"
             [source]="dataAdapter" [columns]="labourRateColumns" (onRowdoubleclick)="onRowDobleClick($event)"
             [theme]="'office'" [sortable]="true" (onCellendedit)="calculateCurrentRateSum()"
             [filterable]="true" [editable]="true" [selectionmode]='"multiplerows"' >
    </jqxGrid>
    <div class="form-group row" style="padding-top: 2rem;">
      <div class="col-md-12 d-flex justify-content-end">
        <div class="field">
          <label class="p-float-label" for="totalLabourBill">Labour Total</label>
        </div>

        <div class="field" style="padding-left: 2rem">
          <input type="text" disabled class="p-inputtext" id="totalLabourBill" [(ngModel)]="kcpBill.totalLabourBill"  required autofocus />
          <!-- <small class="p-error" *ngIf="submitted && !message.question">Bill No is required.</small> -->
        </div>
      </div>
    </div>

    <div class="form-group row" style="padding-top: 2rem;">
      <div class="col-md-6 d-flex justify-content-start">
        <div  class="field">
          <jqxButton class="btn btn-primary" (click)="saveEntity()" >Save</jqxButton>
        </div>
        <div *ngIf="!id" class="field" style="padding-left: 2rem">
          <jqxButton class="btn btn-secondary" (click)="resetForm()" >Reset</jqxButton>
          <!-- <small class="p-error" *ngIf="submitted && !message.question">Bill No is required.</small> -->
        </div>
      </div>
      <div class="col-md-6 d-flex justify-content-end">
        <div class="field">
          <label class="p-float-label" for="totalBill">Gross Total</label>
        </div>
        <div class="field" style="padding-left: 2rem">
          <input type="text" disabled class="p-inputtext" id="totalBill" [(ngModel)]="kcpBill.totalBill"  required autofocus />
          <!-- <small class="p-error" *ngIf="submitted && !message.question">Bill No is required.</small> -->
        </div>
      </div>
    </div>
  </app-card>
</div>

<app-card>
  <jqxButton *ngIf="base64" class="btn btn-secondary"  (click)="CancelPdf()">Cancel</jqxButton>
  <iframe *ngIf="base64" [src]="getPdfDataUrl()" width="100%" height="600"></iframe>

</app-card>
